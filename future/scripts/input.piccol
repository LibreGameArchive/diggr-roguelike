

handle_input InState->OutState :-

  <: \c == 'S' :> ? OutState{ticks=\ticks done=true dead=false} ;
  <: \c == 'Q' :> ? OutState{ticks=\ticks done=true dead=true} ;
  <: \c == '.' :> ? OutState{ticks=(<: \ticks + 1u :>) done=false dead=false} ;
 
  OutState{ticks=\ticks done=false dead=false} 
.
